Detonate asks for the average fragment length. So I found the information on SRA

```{.bash}
ml StdEnv/2023 edirect/20.9.20231210
cd $SCRATCH/expression

efetch -db sra -id $(cat accs) > SRA_run_info.csv

ml StdEnv/2020 r/4.3.1

'library("tidyverse")
read_csv("SRA_run_info.csv") %>% 
    dplyr::select(ScientificName, ProjectID, Run, 
                  spots, avgLength, InsertSize, LibraryName, 
                  LibrarySelection, Model, SampleName) %>% 
    mutate(ProjectID = paste0("PRJNA", ProjectID)) %>%
    arrange(ScientificName, ProjectID, LibraryName) %>% 
    write_delim("SRA_info.txt", delim="\t")' > tmp.R
Rscript tmp.R

#awk -F ',' ' NR>1 {print $1, $4, ($7+$17)}' SRA_run_info.csv > spot_size.txt
```
Then, export the file to home computer and enter data from articles

Then in R, I calculated:
for each run:
size_times_spots = (spot_length + insert_size) * n_spots
which I used to calculate, for each species:
average_frag_length = sum(size_times_spots) / sum(n_spots)

R script:
```{.r}
library(tidyverse)
metadata = read_delim("expression/metadata")
spot_size=read_delim("spot_size.txt", delim=" ", col_names=c("Run", "Number_of_spots", "Spot_size"))
left_join(metadata, spot_size) %>% 
 mutate(Nspots_times_length = Number_of_spots*Spot_size) %>% 
 group_by(Organism) %>% 
 summarize(Mean_spot_length = sum(Nspots_times_length)/sum(Number_of_spots)) %>% 
 write_delim(file = "expression/average_spot_length", delim = "\t")
```
